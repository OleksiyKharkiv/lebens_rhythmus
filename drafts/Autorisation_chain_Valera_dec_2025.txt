–æ—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ **–≥—Ä–∞–Ω–∏—Ü–∞ –º–µ–∂–¥—É ¬´—Ä–∞–±–æ—Ç–∞–µ—Ç¬ª –∏ ¬´–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ¬ª**.
–û—Ç–≤–µ—á–∞—é –ø–æ –ø–æ—Ä—è–¥–∫—É, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —Ç–æ, —á—Ç–æ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å –∏ —á—Ç–æ –±—É–¥–µ—Ç –¥–∞–ª—å—à–µ (–º–Ω–æ–≥–æ—Ä–æ–ª–µ–≤–∫–∞, ERM).

---

## 0Ô∏è‚É£ –ì–ª–∞–≤–Ω–æ–µ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ —Å–Ω—è—Ç—å —Å—Ä–∞–∑—É

> ¬´–ï—Å–ª–∏ —É–±—Ä–∞—Ç—å `checkAuthStatus()` —Å login.js ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è¬ª

‚ùå **–Ω–µ—Ç**

JWT ‚â† session cookie
JWT ‚Äî —ç—Ç–æ **—Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –ø—Ä–æ–ø—É—Å–∫**, –∞ –Ω–µ ¬´—Å–µ—Å—Å–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ª–æ–≥–∏–Ω–∞¬ª.

---

## 1Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å (must have)

### –ï—Å—Ç—å 3 —Ç–∏–ø–∞ —Å—Ç—Ä–∞–Ω–∏—Ü

### üîì PUBLIC

* `/login`
* `/register`
* `/forgot-password`
* landing

üëâ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç JWT**
üëâ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ—Ä–≥–∞—é—Ç `/users/me`**

---

### üîê PROTECTED

* `/dashboard`
* `/profile`
* `/admin`
* `/teacher`

üëâ **–æ–±—è–∑–∞–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å JWT**
üëâ **–∏–º–µ–Ω–Ω–æ —Ç—É—Ç –Ω—É–∂–Ω–∞ `checkAuthStatus()`**

---

### üß† ROLE-AWARE

* `/admin/**`
* `/teacher/**`
* `/participant/**`

üëâ JWT **—Å role/authorities**
üëâ frontend **–Ω–µ —Ä–µ—à–∞–µ—Ç**, backend —Ä–µ—à–∞–µ—Ç

---

## 2Ô∏è‚É£ –ß—Ç–æ —Ä–µ–∞–ª—å–Ω–æ —è–≤–ª—è–µ—Ç—Å—è source of truth

‚ùó **–ù–ï frontend**
‚ùó **–ù–ï localStorage**
‚ùó **–ù–ï expiry –≤ JS**

### ‚úîÔ∏è Source of truth = BACKEND + JWT SIGNATURE

Frontend **—Ç–æ–ª—å–∫–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç**:

> ¬´—è –µ—â—ë –ª–µ–≥–∞–ª–µ–Ω –∏–ª–∏ –Ω–µ—Ç?¬ª

---

## 3Ô∏è‚É£ Best practice flow (–∫–∞–∫ –¥–µ–ª–∞—é—Ç –≤–∑—Ä–æ—Å–ª—ã–µ –ø—Ä–æ–µ–∫—Ç—ã)

### üîÅ 1. Login / Register

```text
POST /api/auth/login
‚Üí JWT
‚Üí localStorage
‚Üí redirect ‚Üí /dashboard
```

–ù–ò–ö–ê–ö–ò–• `checkAuthStatus()` –Ω–∞ login —Å—Ç—Ä–∞–Ω–∏—Ü–µ.

---

### üîÅ 2. Protected page (dashboard.js)

```js
document.addEventListener('DOMContentLoaded', async () => {
    await requireAuth();
});
```

### `requireAuth()` ‚Äî —ç—Ç–æ —Ç–≤–æ–π guard

```js
async function requireAuth() {
    const token = localStorage.getItem('authToken');
    const expiry = localStorage.getItem('tokenExpiry');

    if (!token || !expiry || Date.now() >= Number(expiry)) {
        clearAuthData();
        window.location.href = '/login.html';
        return;
    }

    const response = await fetch(`${API_BASE_URL}/users/me`, {
        headers: { Authorization: `Bearer ${token}` }
    });

    if (!response.ok) {
        clearAuthData();
        window.location.href = '/login.html';
        return;
    }

    const user = await response.json();
    applyUserContext(user);
}
```

üëâ **–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å**
üëâ **–æ–¥–Ω–∞ —Ç–æ—á–∫–∞ –∏—Å—Ç–∏–Ω—ã**
üëâ **–Ω–∏–∫–∞–∫–æ–≥–æ –¥—Ä–æ—á–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

---

## 4Ô∏è‚É£ –ü–æ—á–µ–º—É `/users/me` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–æ—á–∫–∞

–ü–æ—Ç–æ–º—É —á—Ç–æ:

* JWT –º–æ–∂–µ—Ç –±—ã—Ç—å:

  * –æ—Ç–æ–∑–≤–∞–Ω
  * –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
  * role –∏–∑–º–µ–Ω–µ–Ω–∞
* backend **–∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ —Å–∫–∞–∑–∞—Ç—å –ù–ï–¢**, –¥–∞–∂–µ –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –≤–∞–ª–∏–¥–µ–Ω

–¢—ã —É–∂–µ –∑–∞–ª–æ–∂–∏–ª —ç—Ç–æ:

```java
if (user.getLockUntil() != null)
```

‚úî –æ—Ç–ª–∏—á–Ω–æ

---

## 5Ô∏è‚É£ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å —Ä–æ–ª—è–º–∏ (—Ç—ã –∫ —ç—Ç–æ–º—É —É–∂–µ –≥–æ—Ç–æ–≤)

### JWT payload (–ø—Ä–∏–º–µ—Ä)

```json
{
  "sub": "oleksiy@...",
  "roles": ["PARTICIPANT", "TEACHER"],
  "exp": 1739999999
}
```

### Backend

```java
@PreAuthorize("hasRole('ADMIN')")
@GetMapping("/admin/users")
```

### Frontend

```js
function redirectBasedOnRole(role) {
    if (role === 'ADMIN') location.href = '/admin';
    else if (role === 'TEACHER') location.href = '/teacher';
    else location.href = '/dashboard';
}
```

‚ö†Ô∏è frontend ‚Äî **—Ç–æ–ª—å–∫–æ UX**, –Ω–µ security

---

## 6Ô∏è‚É£ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å `checkAuthStatus()` –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —É —Ç–µ–±—è

### ‚ùå –ù–ï –¢–ê–ö

* global
* –Ω–∞ login
* –Ω–∞ register

### ‚úÖ –¢–ê–ö

* –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ `requireAuth()`
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç–æ–ª—å–∫–æ** –≤ protected pages

---

## 7Ô∏è‚É£ –ü–æ—á–µ–º—É —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –±—ã–ª –æ–ø–∞—Å–µ–Ω

–¢—ã –¥–µ–ª–∞–ª:

```text
login.html
‚Üí checkAuthStatus()
‚Üí /users/me
‚Üí Authorization: Bearer <–º—É—Å–æ—Ä>
‚Üí SecurityFilterChain
‚Üí 500
```

–≠—Ç–æ –Ω–µ ¬´–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏¬ª,
—ç—Ç–æ **—Å—Ç—Ä–µ–ª—å–±–∞ –∏–∑ JWT –≤ —Ç–µ–º–Ω–æ—Ç–µ**.

---

## 8Ô∏è‚É£ –ö–æ—Ä–æ—Ç–∫–æ, –∫–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ

```
/public
  login.js
  register.js

/protected
  auth-guard.js   ‚Üê requireAuth()
  dashboard.js
  profile.js
  admin.js
```

---

## 9Ô∏è‚É£ ERM –∏ –±—É–¥—É—â–µ–µ (—Ç—ã –≤—Å—ë —Å–¥–µ–ª–∞–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

–¢–≤–æ—è ERM:

* User
* Participant
* Teacher
* Group / Workshop
* Role-based —Å–≤—è–∑–∏

üëâ **JWT + `/users/me` –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∏–¥–µ–∞–ª—å–Ω–æ**
üëâ —Ä–æ–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å:

* —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏
* –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏
* –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∫ Group / Workshop

---

## üîö –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–≤–æ–π –≤–æ–ø—Ä–æ—Å

> ¬´–ö–∞–∫ –Ω–µ –∑–∞–¥—Ä–∞—á–∏–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π?¬ª

‚úî **–ù–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å JWT –Ω–∞ login**
‚úî **–ü—Ä–æ–≤–µ—Ä—è—Ç—å JWT —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –∑–∞—â–∏—â—ë–Ω–Ω—É—é –∑–æ–Ω—É**
‚úî **–í—Å–µ–≥–¥–∞ –≤–µ—Ä–∏—Ç—å backend**
‚úî **JWT = –ø—Ä–æ–ø—É—Å–∫, –Ω–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ UI**

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º:

* —è –ø–æ–º–æ–≥—É –≤—ã–Ω–µ—Å—Ç–∏ `auth-guard.js`
* –∏–ª–∏ —Å—Ä–∞–∑—É —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º JWT claims –ø–æ–¥ —Ç–≤–æ—é ERM (groups / workshops / roles)
